<!DOCTYPE html>
<html lang="vi-EN" />
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Stretchy header &middot; VietHQ</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://gg4acrossover.github.io/hugosite/favicon.ico" />
    <link rel="canonical" href="https://gg4acrossover.github.io/hugosite/stretchy-header/" />

     <meta name="description" content="1.Tản mạn Tạo stretchy header là kỹ thuật không mới nhưng cho hiệu ứng khá đẹp mắt, hiện nay vẫn được nhiều app ưa chuộng dùng lại. Trước đây, hồi còn chưa ra s" /> 

     
    
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image" content="https://gg4acrossover.github.io/hugosite/images/cover/3.jpg"/>
    
 
    <meta name="twitter:title" content="Stretchy header"/>
    <meta name="twitter:description" content="1.Tản mạn Tạo stretchy header là kỹ thuật không mới nhưng cho hiệu ứng khá đẹp mắt, hiện nay vẫn được nhiều app ưa chuộng dùng lại. Trước đây, hồi còn chưa ra s"/>
    <meta name="twitter:url" content="https://gg4acrossover.github.io/hugosite/stretchy-header/" />
    <meta name="twitter:site" content="@"/>

    <meta property="og:site_name" content="VietHQ" />
    <meta property="og:title" content="Stretchy header &middot; VietHQ" />
    <meta property="og:url" content="https://gg4acrossover.github.io/hugosite/stretchy-header/" />
    

    <meta property="og:type" content="article" />
    <meta property="og:description" content="1.Tản mạn Tạo stretchy header là kỹ thuật không mới nhưng cho hiệu ứng khá đẹp mắt, hiện nay vẫn được nhiều app ưa chuộng dùng lại. Trước đây, hồi còn chưa ra s" />

    <meta property="article:published_time" content="2018-04-28T01:44:57&#43;07:00" />
    <meta property="article:tag" content="swift4" /><meta property="article:tag" content="ios" />

    <meta property="og:image" content="https://gg4acrossover.github.io/hugosite/images/cover/3.jpg"/>


    <meta name="generator" content="Hugo 0.37.1" />

    <!-- Stylesheets -->
    <link rel="stylesheet" type="text/css" href="https://gg4acrossover.github.io/hugosite/built/screen.css" /> 
    <link rel="stylesheet" type="text/css" href="https://gg4acrossover.github.io/hugosite/css/casper-two.css" /> 
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" />
    

     

</head>


<body class="post-template">
  <div class="site-wrapper"> 

<header class="site-header outer">
  <div class="inner">
    <nav class="site-nav">
      <div class="site-nav-left">

        <ul class="nav" role="menu">
        
        
        
            <li class="" role="menuitem">
              <a href="https://twitter.com/viet142">Twitter</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="https://github.com/gg4acrossover">Github</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/hugosite/about/">About me</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/hugosite/">Home</a>
            </li>
        
      </ul></div>

      <div class="site-nav-right">
        <div class="social-links">
                    

                    

                    

                    

                    
        </div>  
            
      </div>

    </nav>  

  </div>
</header>

<main id="site-main" class="site-main outer" role="main">
  <div class="inner">
    
      <article class="post-full post"> 
    <header class="post-full-header">
        <section class="post-full-meta">
            <time class="post-full-meta-date" datetime="2018-04-28">28 April 2018</time>
                <span class="date-divider">/</span> <a href="https://gg4acrossover.github.io/hugosite/tags/swift4/">#swift4</a>&nbsp;<a href="https://gg4acrossover.github.io/hugosite/tags/ios/">#ios</a>&nbsp;
        </section>
        <h1 class="post-full-title">Stretchy header</h1>
    </header>
    
    <figure class="post-full-image" style="background-image: url(https://gg4acrossover.github.io/hugosite/images/cover/3.jpg)">
    </figure>

    <section class="post-full-content">
        <div class="kg-card-markdown">
        

<h3 id="1-tản-mạn">1.Tản mạn</h3>

<p>Tạo stretchy header là kỹ thuật không mới nhưng cho hiệu ứng khá đẹp mắt, hiện nay vẫn được nhiều app ưa chuộng dùng lại. Trước đây, hồi còn chưa ra swift, thấy trò này hay quá, mình cũng mày mò tự tạo một cái, tuy nhiên chưa có cơ hội áp dụng vào dự án thực tế. Ở công ty hiện tại, mình được chủ động hơn trong công việc, nên cũng tùy tiện gắn stretchy header vào cho có chút phá cách. Ngoài ra mình cũng thấy một bạn post hỏi cách tạo stretchy header trên cộng đồng IOS, nên tiện lúc ngứa tay, mình post lên dây chia sẻ <em>mình đã tạo stretchy header ra sao</em>.</p>

<h3 id="2-hướng-đi">2. Hướng đi</h3>

<p>Mình không sử dụng <em>header</em> mặc định của <em>UITableView</em>. Thế nên mình triển khai theo cách tạo một khoảng trống phía trên UITableView(UIScrollView nói chung), khoảng trống này đủ rộng để hiển thị <em>header</em> mình tạo. Sau đó điều chỉnh <em>frame</em> của <em>header</em> cập nhật theo sự kiện <em>scroll</em>. Có nhiều cách để cập nhật lại frame của header ví dụ như sử dụng hàm <em>scrollViewDidScroll</em> trong <em>UIScrollViewDelegate</em>, hoặc sử dụng <em>KVO</em> để bắt sự thay đổi của thuộc tính contentOffset. Trong ví dụ lần này mình sử dụng cả 2 cách trên.</p>

<h3 id="3-cách-đơn-giản-nhất">3. Cách đơn giản nhất</h3>

<p>Viết code chú trọng giản tiện, code càng ít bug càng nhỏ. Như hướng đi trên, mình phân ra làm 3 bước quan trọng:</p>

<ul>
<li>Bước 1: Tạo content inset top cho tableview, mục đích là tạo ra 1 khoảng trống để gắn header.</li>
</ul>

<p><img src="/hugosite/images/note/stretchy-header-1.png" alt="image2" /></p>

<ul>
<li>Bước 2: Gắn 1 custom view vào đúng vị trí trống do bước 1 hình thành. Nếu view bạn tạo ra là <em>UIImageView</em> thì nên để thuộc tính content là <em>scaleAspectFill</em> (scale ảnh giữ đúng tỉ lệ). Đối với trường hợp này, gắn trực tiếp vào viewcontroller, chứ không phải <em>tableview</em></li>
</ul>

<p><img src="/hugosite/images/note/stretchy-header-2.png" alt="image2" /></p>

<ul>
<li>Bước 3: Co giãn frame dựa vào hàm <em>scrollViewDidScroll</em>, nhìn code thì dài nhưng thực ra chỉ tính toán lại frame.</li>
</ul>

<p><img src="/hugosite/images/note/stretchy-header-3.png" alt="image2" /></p>

<h3 id="4-cách-tạo-trường-hợp-tổng-quát">4. Cách tạo trường hợp tổng quát</h3>

<p>Để tạo trường hợp tổng quát thì mình gắn header vào trong *scrollview(tableview)(. Đây là cách mà các thư viện hay sử dụng. Để làm được theo cách này ta cần phải biết thêm về KVO, biết cách thêm property vào extension của các class có sẵn trong <em>Cocoa</em>. Nghe thôi cũng đã thêm nhiều thứ rồi nhỉ? Các bước tiến hành cũng na ná như cách đầu tiên, tuy nhiên có lưu ý nho nhỏ:</p>

<ul>
<li>Vị trí originY của stretchy header lúc này thường là <em>contentOffset.y</em> của scrollview.</li>
<li>Vì gắn custom view vào scroll view nên ta cần điều chỉnh frame của header theo sự thay đổi của <em>contentOffset.y</em>. Sử dụng KVO trong trường hợp này là hợp lý.</li>
</ul>

<h3 id="5-gắn-vào-trong-tableview">5. Gắn vào trong Tableview</h3>

<p>Cách này tương tự cách làm tổng quát, tuy nhiên không cần dùng đến KVO, không cần đến extension, thế nên việc xử lý đơn giản đi khá nhiều. Nhược điểm của nó là khi cần áp dụng vào tableview khác thì Ctrl Only C từ chỗ này qua chỗ khác :D, nói chung là cũng nhanh. Vậy nên mọi người dựa vào 2 cách trên để tự làm cách này nhé. Good luck!</p>

<p><a href="https://github.com/gg4acrossover/stretchy-header">Source code</a> để mọi người tham khảo.</p>

<p>Dưới đây là thành quả cho có tí động lực</p>

<p><img src="https://media.giphy.com/media/5tkNzzBCp7GCyLAIYT/giphy.gif" alt="image2" /></p>
    
        </div>
    </section>

    <footer class="post-full-footer">
      <section class="author-card">
        <img class="author-profile-image" src="https://gg4acrossover.github.io/hugosite/" alt="Author" />
        <section class="author-card-content">
            <h4 class="author-card-name"><a href="https://gg4acrossover.github.io/">viethq</a></h4>
                <p>VietHQ - Tìm đơn giản trong phức tạp</p>
        </section>
      </section>
    </footer>
</article>
    
    
    

<div id="disqus_thread"></div>
<script>




var disqus_config = function () {
this.page.url = "https:\/\/gg4acrossover.github.io\/hugosite\/stretchy-header\/";  
this.page.identifier = "https:\/\/gg4acrossover.github.io\/hugosite\/stretchy-header\/"; 
};

(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://gg4acrossover.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  </div>
</main>


<aside class="read-next outer">
  <div class="inner">
    <div class="read-next-feed">      
      
<article class="read-next-card" style="background-color: #090a0b;">
    <header class="read-next-card-header">
        <small class="read-next-card-header-sitetitle">&mdash; VietHQ &mdash;</small>
        
        <h3 class="read-next-card-header-title"><a href="https://gg4acrossover.github.io/hugosite/tags/swift4/">#swift4</a></h3>
    </header>
    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
    </div>

    <div class="read-next-card-content">
      
        <ul>
          <li><a href="https://gg4acrossover.github.io/hugosite/slim-tableview/">Slim tableview</a></li>            
        
          <li><a href="https://gg4acrossover.github.io/hugosite/c%C3%A1c-thu%E1%BB%99c-t%C3%ADnh-c%E1%BB%A7a-property-trong-objc/">Các thuộc tính của property trong objC</a></li>            
        
          <li><a href="https://gg4acrossover.github.io/hugosite/code-sach-code-kho-thoang/">Code sạch, code khô thoáng</a></li>            
        
          <li><a href="https://gg4acrossover.github.io/hugosite/enum-flag-c-plus-plus/">Enum flag c&#43;&#43;</a></li>            
        </ul>
    </div>
    <footer class="read-next-card-footer">
      
        <a href="https://gg4acrossover.github.io/hugosite/tags/swift4/">See all related posts →</a>
    </footer>
</article>


      
      
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="https://gg4acrossover.github.io/hugosite/method-dispatch/">
      <div class="post-card-image" style="background-image: url(https://gg4acrossover.github.io/hugosite/images/cover/9.jpg)"></div>
    </a>
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="https://gg4acrossover.github.io/hugosite/method-dispatch/">
          <header class="post-card-header">
              <span class="post-card-tags">
              #swift 
              #ios  </span>
              
              <h2 class="post-card-title">Method dispath trong protocol</h2>
          </header>
          <section class="post-card-excerpt">
              
                <p>Method dispatch là gì? Method dispatch là thuật toán xác định cách thức vận hành method thông qua compiler. Nhắc đến method dispatch, thường người ta sẽ nói đến 2 kiểu điển hình:
 Static dispatch: xác định hàm được chạy trong quá trình biên dịch. Dynamic dispatch: xác định hàm được chạy trong quá trình runtime, cái này thể hiện rõ nhất qua tính đa hình trong OOP.  Với mỗi ngôn ngữ, tùy thuộc vào thiết kế mà có sự khác nhau về cách thức vận hành phương thức. ...  </p>
              
          </section>
      </a>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="https://gg4acrossover.github.io/hugosite/" alt="Author" />
          <span class="post-card-author"><a href="/">viethq</a></span>
      </footer>
    </div>
</article>
      
    </div>
  </div>
</aside>

<div class="floating-header">
  <div class="floating-header-logo">
    <a href="https://gg4acrossover.github.io/">
      
      <span>VietHQ</span>
    </a>
  </div>
  <span class="floating-header-divider">&mdash;</span>
  <div class="floating-header-title">Stretchy header</div>
  <div class="floating-header-share">
    <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
     <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/></svg>
    </div>
    
    <a class="floating-header-share-tw" href="https://twitter.com/share?text=Stretchy%20header&amp;url=https%3a%2f%2fgg4acrossover.github.io%2fhugosite%2fstretchy-header%2f"
          onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
      </a>
      <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fgg4acrossover.github.io%2fhugosite%2fstretchy-header%2f"
          onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
      </a>
  </div>

  <progress class="progress" value="0">
    <div class="progress-container">
      <span class="progress-bar"></span>
    </div>
  </progress>
</div>



<footer class="site-footer outer">
  <div class="site-footer-content inner">
    <section class="copyright" style="line-height: 1.3em;">
      <a href=https://gg4acrossover.github.io/hugosite/>viethq</a>  <br>
      
    </section>
    <nav class="site-footer-nav">
        <a href=https://gg4acrossover.github.io/hugosite/>Latest Posts</a>
        
        
        
        
        
    </nav>  
  </div>
</footer>

</div>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="https://gg4acrossover.github.io/hugosite/js/jquery.fitvids.js"></script>

<script>hljs.initHighlightingOnLoad();</script>



    <script>





$(document).ready(function () {
    
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>
</body></html>
