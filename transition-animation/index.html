<!DOCTYPE html>
<html lang="vi-EN">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  	<meta property="og:title" content=" Transition Animation &middot;  GG4aCrossover" />
  	<meta property="og:site_name" content="GG4aCrossover" />
  	<meta property="og:url" content="https://gg4acrossover.github.io/hugosite/transition-animation/" />

    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2016-09-20T16:01:11&#43;07:00" />

    
    <meta property="og:article:tag" content="objc" />
    
    

  <title>
     Transition Animation &middot;  GG4aCrossover
  </title>

    <meta name="description" content="Life is like riding a bicycle. To keep your balance, you must keep moving." />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://gg4acrossover.github.io/hugosite/images/favicon.ico">
	  <link rel="apple-touch-icon" href="https://gg4acrossover.github.io/hugosite/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="https://gg4acrossover.github.io/hugosite/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="https://gg4acrossover.github.io/hugosite/css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />


    
      
          <link href="https://gg4acrossover.github.io/hugosite/index.xml" rel="alternate" type="application/rss+xml" title="GG4aCrossover" />
      
      
    
    <meta name="generator" content="Hugo 0.16" />

    <link rel="canonical" href="https://gg4acrossover.github.io/hugosite/transition-animation/" />

    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            <h4>My Site</h4>
            <li class="nav-opened" role="presentation">
            	<a href="/hugosite/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/hugosite/about/">About me</a>
            </li>
        
            <h4>Social</h4>
            <li class="nav-opened" role="presentation">
            	<a href="https://github.com/gg4acrossover">Github</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://twitter.com/viet142">Twitter</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="https://gg4acrossover.github.io/hugosite/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Transition Animation</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2016-09-20T16:01:11&#43;07:00">
            Sep 20, 2016
          </time>
        
         
          <span class="post-tag small"><a href="https://gg4acrossover.github.io/hugosite/tags/objc/">#objc</a></span>
         
        </section>
    </header>

    <section class="post-content">
      

<h3 id="giới-thiệu">Giới thiệu</h3>

<p>Bắt đầu từ IOS7, apple hỗ trợ tạo animation lúc chuyển viewcontroller. Quá trình chuyển đổi được hỗ trợ bao gồm:</p>

<ul>
<li>NavigationController</li>
<li>TabbarController</li>
<li>Presentations và dismiss</li>
</ul>

<p>Mình sẽ tập trung vào custom animation <em>push</em> và <em>pop</em> với <em>NavigationController</em>. Với các phương thức chuyển viewcontroller khác thì làm tương tự.</p>

<h3 id="mô-hình-hóa">Mô hình hóa</h3>

<p>Giả sử bạn có 2 viewcontroller A và B, bây giờ bạn muốn push từ A sang B.</p>

<p><img src="/hugosite/images/note/1.jpg" alt="image1" /></p>

<p>Đầu tiên, ta cần khởi tạo <em>transtion</em> và xác định được 2 viewcontroller cần di chuyển, lúc này A đang được chứa bởi <em>container</em>(là view chứa để control việc di chuyển)</p>

<p><img src="/hugosite/images/note/2.jpg" alt="image2" /></p>

<p>Tiếp theo add viewcontroller B vào container đang chứa A.</p>

<p><img src="/hugosite/images/note/3.jpg" alt="image2" /></p>

<p>Cuối cùng là thực hiện animation chuyển đổi giữa 2 màn hình, quá trình kết thúc khi A được remove khỏi container</p>

<p><img src="/hugosite/images/note/4.jpg" alt="image2" /></p>

<h3 id="implement">Implement</h3>

<p>Để thực hiện được mô hình trên, ta sử dụng những protocol sau</p>

<h4 id="uinavigationcontrollerdelegate">UINavigationControllerDelegate</h4>

<p>Protocol có 2 method giúp ta xác định được cách thức transition</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">-</span> (nullable id <span style="color: #666666">&lt;</span>UIViewControllerInteractiveTransitioning<span style="color: #666666">&gt;</span>)<span style="color: #A0A000">navigationController</span>:(UINavigationController <span style="color: #666666">*</span>)navigationController
                          <span style="color: #A0A000">interactionControllerForAnimationController</span>:(id <span style="color: #666666">&lt;</span>UIViewControllerAnimatedTransitioning<span style="color: #666666">&gt;</span>) animationController NS_AVAILABLE_IOS(<span style="color: #666666">7</span>_0);

<span style="color: #666666">-</span> (nullable id <span style="color: #666666">&lt;</span>UIViewControllerAnimatedTransitioning<span style="color: #666666">&gt;</span>)<span style="color: #A0A000">navigationController</span>:(UINavigationController <span style="color: #666666">*</span>)navigationController
                                   <span style="color: #A0A000">animationControllerForOperation</span>:(UINavigationControllerOperation)operation
                                                <span style="color: #A0A000">fromViewController</span>:(UIViewController <span style="color: #666666">*</span>)fromVC
                                                  <span style="color: #A0A000">toViewController</span>:(UIViewController <span style="color: #666666">*</span>)toVC  NS_AVAILABLE_IOS(<span style="color: #666666">7</span>_0);
</pre></div>


<p>Hàm đầu tiên dùng để bắt các sự kiện touch vào màn hình, trả về object implement <em>UIViewControllerInteractiveTransitioning</em>.</p>

<p>Hàm thứ hai thực hiện việc push/pop khi ta click action (next/back) trên thanh navigation bar, trả về object implement <em>UIViewControllerAnimatedTransitioning</em>. Các params giúp ta xác định được <em>fromVC</em> là viewcontroller nào, <em>toVC</em> là viewcontroller nào. Ở trường hợp di chuyển từ A sang B thì A là <em>fromVC</em> và B là <em>toVC</em>.
Cuối cùng là param <em>operation</em>, đây là enum gồm có 3 value để xác định trạng thái push hay pop</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span> UINavigationControllerOperationNone,
 UINavigationControllerOperationPush,
 UINavigationControllerOperationPop,
</pre></div>


<h4 id="uiviewcontrolleranimatedtransitioning">UIViewControllerAnimatedTransitioning</h4>

<p>có 2 phương thức</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">-</span> (NSTimeInterval)<span style="color: #A0A000">transitionDuration</span>:(nullable id <span style="color: #666666">&lt;</span>UIViewControllerContextTransitioning<span style="color: #666666">&gt;</span>)transitionContext;

<span style="color: #666666">-</span> (<span style="color: #00BB00; font-weight: bold">void</span>)<span style="color: #A0A000">animateTransition</span>:(id <span style="color: #666666">&lt;</span>UIViewControllerContextTransitioning<span style="color: #666666">&gt;</span>)transitionContext;
</pre></div>


<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">-</span> (NSTimeInterval)<span style="color: #A0A000">transitionDuration</span>:(nullable id <span style="color: #666666">&lt;</span>UIViewControllerContextTransitioning<span style="color: #666666">&gt;</span>)transitionContext;

<span style="color: #666666">-</span> (<span style="color: #00BB00; font-weight: bold">void</span>)<span style="color: #A0A000">animateTransition</span>:(id <span style="color: #666666">&lt;</span>UIViewControllerContextTransitioning<span style="color: #666666">&gt;</span>)transitionContext;
</pre></div>


<p>Để thực hiện animation ta cần 2 thông số, thông số đầu tiên là duration, hàm đầu tiên giúp ta xác định được điều đó. Phương thức thứ hai dùng để implement animation chuyển đổi. Trong hàm này ta cần đưa ra thông báo để biết được quá trình push/pop được hoàn thành</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>[transitionContext <span style="color: #A0A000">completeTransition</span>:<span style="color: #666666">!</span>[transitionContext transitionWasCancelled]];
</pre></div>


<h4 id="example">Example</h4>

<p><strong>Bước 1:</strong> Tạo ra object implement protocol <em>UIViewControllerAnimatedTransitioning</em>, trước hết xác định duration</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">-</span> (NSTimeInterval)<span style="color: #A0A000">transitionDuration</span>:(id <span style="color: #666666">&lt;</span>UIViewControllerContextTransitioning<span style="color: #666666">&gt;</span>)transitionContext
{
    <span style="color: #AA22FF; font-weight: bold">return</span> <span style="color: #666666">0.25</span>;
}
</pre></div>


<p>Định nghĩa một animation đơn giản</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008800; font-style: italic">/**</span>
<span style="color: #008800; font-style: italic"> * using example in </span>
<span style="color: #008800; font-style: italic"> * https://www.objc.io/issues/5-ios7/view-controller-transitions/ </span>
<span style="color: #008800; font-style: italic"> */</span>

<span style="color: #666666">-</span> (<span style="color: #00BB00; font-weight: bold">void</span>)<span style="color: #A0A000">animateTransition</span>:(id<span style="color: #666666">&lt;</span>UIViewControllerContextTransitioning<span style="color: #666666">&gt;</span>)transitionContext
{
    <span style="color: #008800; font-style: italic">//1.</span>
    UIViewController<span style="color: #666666">*</span> toViewController <span style="color: #666666">=</span> [transitionContext <span style="color: #A0A000">viewControllerForKey</span>:UITransitionContextToViewControllerKey];
    UIViewController<span style="color: #666666">*</span> fromViewController <span style="color: #666666">=</span> [transitionContext <span style="color: #A0A000">viewControllerForKey</span>:UITransitionContextFromViewControllerKey];

    <span style="color: #008800; font-style: italic">//2.</span>
    [[transitionContext containerView] <span style="color: #A0A000">addSubview</span>:toViewController.view];
    toViewController.view.alpha <span style="color: #666666">=</span> <span style="color: #666666">0</span>;

    <span style="color: #008800; font-style: italic">//3.</span>
    [UIView <span style="color: #A0A000">animateWithDuration</span>:[self <span style="color: #A0A000">transitionDuration</span>:transitionContext] <span style="color: #A0A000">animations</span>:<span style="color: #666666">^</span>{
        fromViewController.view.transform <span style="color: #666666">=</span> CGAffineTransformMakeScale(<span style="color: #666666">0.1</span>, <span style="color: #666666">0.1</span>);
        toViewController.view.alpha <span style="color: #666666">=</span> <span style="color: #666666">1</span>;
    } <span style="color: #A0A000">completion</span>:<span style="color: #666666">^</span>(BOOL finished) {
        fromViewController.view.transform <span style="color: #666666">=</span> CGAffineTransformIdentity;

        <span style="color: #008800; font-style: italic">//4.</span>
        [transitionContext <span style="color: #A0A000">completeTransition</span>:<span style="color: #666666">!</span>[transitionContext transitionWasCancelled]];

    }];

}
</pre></div>


<p>Phân tích chút nào:</p>

<ul>
<li>Bước 1: xác định toViewController và fromViewController</li>
<li>Bước 2: add toViewController.view vào trong container</li>
<li>Bước 3: thực hiện animation.</li>
<li>Bước 4: thông báo animation kết thúc qua câu lệnh <em>completeTransition</em></li>
</ul>

<p><strong>Bước 2:</strong>
Tạo object implement protocol <em>UINavigationControllerDelegate</em>, trong object này ta cần truyền vào object đã implement <em>UIViewControllerAnimatedTransitioning</em> trước đó.</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">-</span>(id<span style="color: #666666">&lt;</span>UIViewControllerAnimatedTransitioning<span style="color: #666666">&gt;</span>)<span style="color: #A0A000">navigationController</span>:(UINavigationController <span style="color: #666666">*</span>)navigationController
                                 <span style="color: #A0A000">animationControllerForOperation</span>:(UINavigationControllerOperation)operation
                                              <span style="color: #A0A000">fromViewController</span>:(UIViewController <span style="color: #666666">*</span>)fromVC
                                                <span style="color: #A0A000">toViewController</span>:(UIViewController <span style="color: #666666">*</span>)toVC
{
    <span style="color: #008800; font-style: italic">// return your custom animation transition</span>
}
</pre></div>


<p><strong>Bước 3</strong>
Setting ở viewcontroller, như ở trên ta có viewcontroller A -&gt; B. Ở A ta cần làm như sau trước khi push.</p>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008800; font-style: italic">//1.</span>
self.navigationController.delegate <span style="color: #666666">=</span> <span style="color: #008800; font-style: italic">/* your custom UINavigationControllerDelegate */</span>;
<span style="color: #008800; font-style: italic">//2.</span>
[self.navigationController <span style="color: #A0A000">pushViewController</span>:B <span style="color: #A0A000">animated</span>:YES];
</pre></div>


<p>Ở bước này ta đã có thể push/pop với animation, nhưng để <em>full service</em> ta sẽ gắn thêm <em>interactive animations</em>. Tuy nhiên ở giới hạn bài viết này mình sẽ chỉ nói về animation cho push và pop. Bạn có thể tìm hiểu chi tiết hơn ở <a href="https://github.com/objcio/issue5-view-controller-transitions">ví dụ</a> của trang <a href="https://www.objc.io/">objc.io</a></p>

<p>Một animation mình làm</p>

<p><img src="https://media.giphy.com/media/l2Sq1x6bWR3i9S8sU/giphy.gif" alt="gif" /></p>

<p>Bài viết có tham khảo</p>

<ul>
<li><a href="https://www.objc.io/issues/5-ios7/view-controller-transitions/">https://www.objc.io/issues/5-ios7/view-controller-transitions/</a></li>
<li><a href="http://whoisryannystrom.com/2013/10/01/View-Controller-Transition-Orientation/">http://whoisryannystrom.com/2013/10/01/View-Controller-Transition-Orientation/</a></li>
</ul>

    </section>


  <footer class="post-footer">


    

    





<section class="author">
  <h4><a href="https://gg4acrossover.github.io/hugosite/">GG4aCrossover</a></h4>
  
  <p>Coder nhân dân</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">HaNoi, VietNam</span>
    <span class="author-link icon-link"><a href="http://gg4acrossover.github.io/">http://gg4acrossover.github.io/</a></span>
  </div>
</section>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=Transition%20Animation&nbsp;-&nbsp;GG4aCrossover&amp;url=https%3a%2f%2fgg4acrossover.github.io%2fhugosite%2ftransition-animation%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fgg4acrossover.github.io%2fhugosite%2ftransition-animation%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fgg4acrossover.github.io%2fhugosite%2ftransition-animation%2f&amp;description=Transition%20Animation"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fgg4acrossover.github.io%2fhugosite%2ftransition-animation%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    

<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'gg4acrossover';
  var disqus_url = 'https:\/\/gg4acrossover.github.io\/hugosite\/transition-animation\/';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">GG4aCrossover</a> All rights reserved - 2016</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="https://gg4acrossover.github.io/hugosite/js/jquery.js"></script>
    <script type="text/javascript" src="https://gg4acrossover.github.io/hugosite/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://gg4acrossover.github.io/hugosite/js/index.js"></script>
    
</body>
</html>

